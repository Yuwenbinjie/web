<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
	    #wrap{
	    	overflow: hidden;
	    }
		#small{
			float: left;
			width: 300px;
			height: 300px;
			background: url(img/psmall.jpg)no-repeat;
			background-size: 300px 300px;
			position: relative;
			overflow: hidden;
		}
		#big{
			float: left;
			width: 300px;
			height: 300px;
			background: url(img/pbig.jpg)no-repeat;
			background-size: 800px 800px;
		}
		#move{
			width: 100px;
			height: 100px;
			border: 1px solid;
			position: absolute;
			left: 0;
			top: 0;
			display: none;
			background: rgba(0,0,0,0.5);
		}
	</style>
</head>
<body>
	<div id="wrap">
		<div id="small">
			<div id="move"></div>
		</div>
		<div id="big"></div>
	</div>
</body>
<script>
	var move = document.querySelector('#move');
	var small = document.querySelector('#small');
	var lock = 1;//2代表方框已经显示了，1代表未显示
	small.onmouseover = function(obj)
	{
		
		//鼠标移入，move块出现
		if(lock==1){
			move.style.display = "block";
			move.style.left = obj.offsetX-50+"px";
			move.style.top = obj.offsetY-50+"px";
		}
		

		lock=2;

		var offL = move.offsetLeft;
		var offT = move.offsetTop;
		//初始点
		var beginX = obj.clientX;
		var beginY = obj.clientY;
		document.onmousemove = function(n)
		{
          var endX = n.clientX-beginX+offL;
          var endY = n.clientY-beginY+offT;
          move.style.left = endX+"px";
          move.style.top = endY+"px";
         

          //判断是否超出范围
          if(n.clientX<small.offsetLeft||
				n.clientX>small.offsetLeft+small.offsetWidth||
				n.clientY<small.offsetTop||
				n.clientY>small.offsetTop+small.offsetHeight)
          {
             document.onmousemove = null;
             lock=1;
             move.style.display = "none";
          }
			
		}
		/*small.onmouseout = function(ev)
		{
			var e = ev || window.event;
			if(e.clientX<small.offsetLeft||
				e.clientX>small.offsetLeft+small.offsetWidth||
				e.clientY<small.offsetTop||
				e.clientY>small.offsetTop+small.offsetHeight)
			small.onmousemove = null;


		}*/
	}
</script>
</html>