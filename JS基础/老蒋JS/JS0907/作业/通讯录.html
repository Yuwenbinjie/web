<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
	    #boxOut{
			width: 400px;
			/*border: 1px solid;*/
			margin: 0 auto;
			
		}
		#box{
			width: 400px;
			/*border: 1px solid;*/
			margin: 0 auto;
			border-radius: 10px;
			
		}
		#tongxun{
			padding: 10px;
			font-size: 20px;
			/*width: 100%;*/
			text-align: center;
			background: #111;
			color: white;
		}
		.abc{
			width: 100%;
			/*border: 1px solid;*/
			margin: 0 auto;
		}
		.daxie{
			font-size: 18px;
			background: gray;
			color: white;
			padding: 5px 10px;
			border-bottom: 1px solid #ccc;
		}
		.person{
			padding: 0px 10px;
			height: 50px;
			background: #ccc;
			line-height: 50px;

		}
		.name{
			display: inline-block;
		}
		.phone{
			display: inline-block;
			margin-left: 10px;
		}
		.del{
			float: right;
			text-decoration: none;
			color: grey;
		}
		#alter{
			display: none;
			text-align: center;

		}

	</style>
</head>
<body>
<div id="boxOut">
    <div id="alter">
			<input type="text" id="alterName">
			<input type="text" id="alterTell">
			<button id="alterBtn">修改</button>
	</div>
	<div id="box">
	    <div id="tongxun">通讯录</div>
		<!-- <div class="abc">
			<div class="daxie">Y</div>
			<div class="person">
				<div class="name">宇文彬杰</div>
				<div class="phone">15735104793</div>
				<a href="#" class="del">删除</a>
			</div>
			
		</div>

		 -->
		
	</div>
	</div>
	
</body>
<script>
	var str = '[{"daxie":"A","person":[{"name":"艾琳","call":"654654135"}]},{"daxie":"C","person":[{"name":"崔莹星","call":"654654135"}]},{"daxie":"G","person":[{"name":"高超","call":"654654135"},{"name":"郭晓瞎","call":"654654135"}]},{"daxie":"L","person":[{"name":"李小冉","call":"654654135"},{"name":"李小凤","call":"654654135"},{"name":"李梦月","call":"654654135"}]},{"daxie":"M","person":[{"name":"苗杰","call":"654654135"}]},{"daxie":"Q","person":[{"name":"全赢","call":"654654135"}]},{"daxie":"S","person":[{"name":"宋传勇","call":"654654135"},{"name":"孙帅","call":"654654135"},{"name":"孙晓晨","call":"654654135"}]},{"daxie":"T","person":[{"name":"天之冬","call":"654654135"}]},{"daxie":"W","person":[{"name":"王浩亮","call":"654654135"},{"name":"王子好","call":"654654135"},{"name":"吴超敏","call":"654654135"},{"name":"王金柳","call":"654654135"},{"name":"王玉","call":"654654135"},{"name":"王彦琨","call":"654654135"}]},{"daxie":"X","person":[{"name":"许飞","call":"654654135"}]},{"daxie":"Y","person":[{"name":"银子套","call":"654654135"},{"name":"宇文彬杰","call":"654654135"},{"name":"游洲","call":"654654135"},{"name":"杨婷","call":"654654135"}]},{"daxie":"Z","person":[{"name":"张然","call":"654654135"},{"name":"张乐","call":"654654135"},{"name":"邹欣欣","call":"654654135"},{"name":"赵紫韵","call":"654654135"},{"name":"张云","call":"654654135"},{"name":"赵鹏","call":"654654135"}]}]';
    var box = document.querySelector('#box');
    var alter = document.querySelector('#alter');
    var alterName = document.querySelector('#alterName');
    var alterTell = document.querySelector('#alterTell');
    var alterBtn = document.querySelector('#alterBtn');
    var arr = JSON.parse(str);

    for(var i=0;i<arr.length;i++){
    	var per = arr[i].person;
    	var abc = createElement("div",box,"abc");
    	var daxies = createElement("div",abc,"daxie");
    	daxies.innerHTML = arr[i].daxie;
    	for(var j=0;j<per.length;j++){
    		var obj = per[j];
    	    var pers = createElement("div",abc,"person");
    	    var names = createElement("div",pers,"name");
    	    names.innerHTML = obj.name;
    	    var phones = createElement("div",pers,"phone");
    	    phones.innerHTML = obj.call;
    	    var dels = createElement("a",pers,"del");
    	    dels.href = "#";
    	    dels.innerHTML = "删除";
    	    dels.abcBQ = abc;
    	    dels.daxiesBQ = daxies;
    	    dels.indexi = i;
    	    dels.indexj = j;
            
            
            pers.person = arr[i].person[j];
            pers.names = names;
            pers.phones = phones;
            console.log(pers.person)
            
    	    //点击元素开始修改
    	    pers.onclick=function(){
    	    	alter.style.display='block';
    	    	box.style.display='none';
    	    	alterName.value = this.person.name;
    	    	alterTell.value = this.person.call;
    	    	alterBtn.person = this.person;
    	    	alterBtn.names = this.names;
    	    	alterBtn.phones = this.phones;
    	    	console.log(this.person);
    	    }
    	    alterBtn.onclick=function(){
    	    	//修改后改变数组
    	    	this.person.name = alterName.value;
    	    	this.person.call = alterTell.value;
    	    	//修改后改变界面
    	    	this.names.innerHTML = alterName.value;
    	    	this.phones.innerHTML = alterTell.value;
    	    	alter.style.display='none';
    	    	box.style.display='block';
    	    }




            //点击删除按钮
    	    dels.onclick = function(){
    	    	// console.log(obj);
    	    	console.log(this.indexi,this.indexj)
    	    	this.parentNode.parentNode.removeChild(this.parentNode);
    	    	// console.log(this.abcBQ.childElementCount)
    	    	var index = arr[this.indexi].person.indexOf(arr[this.indexi].person[this.indexj]);
    	    	arr[this.indexi].person.splice(index,1);
    	    	if(this.abcBQ.childElementCount == 1){
    	    		this.abcBQ.removeChild(this.daxiesBQ);
    	    	}
                console.log(arr)

    	    }

    	}
    }
    

    function createElement(ele,father,classn){
    	var div = document.createElement(ele);
    	father.appendChild(div);
    	div.className = classn;
    	return div;
    }
</script>
</html>