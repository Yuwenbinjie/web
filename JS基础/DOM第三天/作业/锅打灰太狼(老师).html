<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		#gameWrap{
			width: 320px;
			height: 480px;
			background: url(img/game_bg.jpg);
			box-shadow: 0 0 10px #333;
			position: relative;
			margin: 160px;
		}
		#score{
			height: 45px;
			line-height: 45px;
			padding-left: 80px;
			color: #fff;
			font-size: 18px;
			text-shadow: 0 0 2px #000;
		}
		#progress{
			width: 180px;
			height: 16px;
			position: absolute;
			left: 63px;
			top: 66px;
			background:url(img/progress.png) 0 0 no-repeat;
			background-size: 180px 16px;
			border-radius: 15px;
		}
		#wolfs{
			position: absolute;
			left: 0;
			top: 108px;
		}
		.grayWolf{
			background: url(img/grayWolf.png);
			background-position: 0px bottom;
		}
		.redWolf{
			background: url(img/redWolf.png);
			background-position: 0px bottom;
		}
		#wolfs div{
			width: 108px;
			height: 101px;
			position: absolute;
			left: 18px;
			top: 52px;
		}
		#menu,#gameover{
			position: absolute;
			left: 0;
			right: 0;
			/*width: 100%;*/
			bottom: 32%;
			text-align: center;
			font-size: 24px;
			font-weight: bold;
			color: #f60;
			text-shadow: 0 0 5px #ff0;
		}
		#menu p{
			cursor: pointer;
		}
		#gameover{
			width: 100%;
			height: 100%;
			padding-top: 60%;
			box-sizing: border-box;
			bottom: 0;
			z-index: 2;
			background: rgba(0,0,0,0.3);
			display: none;
		}
		/*同级兄弟标签使用浮动和定位必须都使用*/
	</style>
</head>
<body>
	<div id="gameWrap">
		<div id="score">0</div>
		<div id="progress"></div>
		<div id="wolfs">
			<!-- <div class="grayWolf"></div>
			<div class="redWolf"></div> -->
		</div>
		<div id="menu">
			<p id="start">开始游戏</p>
			<p id="info">游戏说明</p>
		</div>
		<div id="gameover">
			<p>游戏结束</p>
		</div>
	</div>

	<script>
		var wolfBox=document.getElementById('wolfs');
		var scoreEle=document.getElementById('score');
		var overLayer=document.getElementById('gameover');
		var progress=document.getElementById('progress');
		var start=document.getElementById('start');
		var score=0;	
		var timer=null;	
		// var iBtn=true;
		var pos = [
			{x: 18,y: 52},
			{x: 98,y: 8},
			{x: 186,y: 35},
			{x: 15,y: 114},
			{x: 104,y: 84},
			{x: 200,y: 104},
			{x: 32,y: 186},
			{x: 120,y: 166},
			{x: 208,y: 188}
		];
		

		//绑定事件
		start.onclick=function()
		{
			this.parentNode.style.display='none';
			gameStart();

		}

		//开始游戏
		function gameStart()
		{
            timer=setInterval(function()
            {
            	createWolf();
            },2000)
		}

		//创建狼
		function createWolf()
		{
			var oDiv=document.createElement('div');
            var num=rand(0,100);
            oDiv.className=num>85?'redWolf':'grayWolf';
            oDiv.clicked=false;
            oDiv.onclick=function()
            {
              // clearInterval(this.timer);
              if(this.clicked==false)
              {
                 if(this.className=='grayWolf') score+=10;
                 if(this.className=='redWolf') score-=10;
                 scoreEle.innerHTML=score;
                 hitWolf(this);
              }
              this.clicked=true;
            }
            wolfBox.appendChild(oDiv);
            wolfPlay(oDiv);//因为要改变的是oDiv的background
		}

		//狼的出现和回去
		function wolfPlay(wolf)
		{
           var index=rand(0,pos.length-1);
           var x=pos[index].x;
           var y=pos[index].y;
           var i=0;
           var n=1;

           wolf.style.left=x+'px';
           wolf.style.top=y+'px';

           wolf.entertimer=setInterval(function()
           {
           	wolf.style.backgroundPosition=-108*i+'px';
            i+=n;
            if(i==6)
            {
            	n=-1;
            	i+=n;
            }
            if(i<0)
            {
            	clearInterval(wolf.entertimer);
            	if(wolf.className=='redWolf')
            	{
            		score+=10;
            		scoreEle.innerHTML=score;
            	}
            	wolfBox.removeChild(wolf);
            }
           },100)
		}

		//点击特效
        function hitWolf(wolf)
        {
        	var i=6;
        	clearInterval(wolf.entertimer);
        	wolf.timer=setInterval(function()
        	{
        		wolf.style.backgroundPosition=-108*i+'px';
        		i++;
        		if(i==10)
        		{
        			clearInterval(wolf.timer);
        			wolfBox.removeChild(wolf);

        		}
        	},100)
        }

		//随机数函数
		function rand(x,y)
		{
			return Math.floor(Math.random()*(y-x)+x);
		}
	</script>
</body>
</html>